import json




df_edges="""{
	"message": "",
	"code": 200,
	"attributes": {
		"@type": "g:Map",
		"@value": []
	},
	"result": {
		"data": {
			"@type": "g:List",
			"@value": [{
				"@type": "g:Path",
				"@value": {
					"labels": {
						"@type": "g:List",
						"@value": [{
							"@type": "g:Set",
							"@value": []
						}, {
							"@type": "g:Set",
							"@value": []
						}]
					},
					"objects": {
						"@type": "g:List",
						"@value": ["Apple Inc", {
							"@type": "g:Edge",
							"@value": {
								"id": "CS769",
								"label": "supplies",
								"inVLabel": "company",
								"outVLabel": "company",
								"inV": "GB0008847096",
								"outV": "US0378331005"
							}
						}]
					}
				}
			}, {
				"@type": "g:Path",
				"@value": {
					"labels": {
						"@type": "g:List",
						"@value": [{
							"@type": "g:Set",
							"@value": []
						}, {
							"@type": "g:Set",
							"@value": []
						}]
					},
					"objects": {
						"@type": "g:List",
						"@value": ["Apple Inc", {
							"@type": "g:Edge",
							"@value": {
								"id": "CS1131",
								"label": "supplies",
								"inVLabel": "company",
								"outVLabel": "company",
								"inV": "US5010441013",
								"outV": "US0378331005"
							}
						}]
					}
				}
			}, {
				"@type": "g:Path",
				"@value": {
					"labels": {
						"@type": "g:List",
						"@value": [{
							"@type": "g:Set",
							"@value": []
						}, {
							"@type": "g:Set",
							"@value": []
						}]
					},
					"objects": {
						"@type": "g:List",
						"@value": ["Apple Inc", {
							"@type": "g:Edge",
							"@value": {
								"id": "CS1254",
								"label": "supplies",
								"inVLabel": "company",
								"outVLabel": "company",
								"inV": "FR0000120172",
								"outV": "US0378331005"
							}
						}]
					}
				}
			}, {
				"@type": "g:Path",
				"@value": {
					"labels": {
						"@type": "g:List",
						"@value": [{
							"@type": "g:Set",
							"@value": []
						}, {
							"@type": "g:Set",
							"@value": []
						}]
					},
					"objects": {
						"@type": "g:List",
						"@value": ["Apple Inc", {
							"@type": "g:Edge",
							"@value": {
								"id": "CS1920",
								"label": "supplies",
								"inVLabel": "company",
								"outVLabel": "company",
								"inV": "DE000BFB0019",
								"outV": "US0378331005"
							}
						}]
					}
				}
			}, {
				"@type": "g:Path",
				"@value": {
					"labels": {
						"@type": "g:List",
						"@value": [{
							"@type": "g:Set",
							"@value": []
						}, {
							"@type": "g:Set",
							"@value": []
						}]
					},
					"objects": {
						"@type": "g:List",
						"@value": ["Apple Inc", {
							"@type": "g:Edge",
							"@value": {
								"id": "CS2094",
								"label": "supplies",
								"inVLabel": "company",
								"outVLabel": "company",
								"inV": "FR0000125585",
								"outV": "US0378331005"
							}
						}]
					}
				}
			}, {
				"@type": "g:Path",
				"@value": {
					"labels": {
						"@type": "g:List",
						"@value": [{
							"@type": "g:Set",
							"@value": []
						}, {
							"@type": "g:Set",
							"@value": []
						}]
					},
					"objects": {
						"@type": "g:List",
						"@value": ["Apple Inc", {
							"@type": "g:Edge",
							"@value": {
								"id": "CD1233",
								"label": "supplies",
								"inVLabel": "company",
								"outVLabel": "company",
								"inV": "US0865161014",
								"outV": "US0378331005"
							}
						}]
					}
				}
			}, {
				"@type": "g:Path",
				"@value": {
					"labels": {
						"@type": "g:List",
						"@value": [{
							"@type": "g:Set",
							"@value": []
						}, {
							"@type": "g:Set",
							"@value": []
						}]
					},
					"objects": {
						"@type": "g:List",
						"@value": ["Apple Inc", {
							"@type": "g:Edge",
							"@value": {
								"id": "CD1282",
								"label": "supplies",
								"inVLabel": "company",
								"outVLabel": "company",
								"inV": "CNE000001KF2",
								"outV": "US0378331005"
							}
						}]
					}
				}
			}, {
				"@type": "g:Path",
				"@value": {
					"labels": {
						"@type": "g:List",
						"@value": [{
							"@type": "g:Set",
							"@value": []
						}, {
							"@type": "g:Set",
							"@value": []
						}]
					},
					"objects": {
						"@type": "g:List",
						"@value": ["Apple Inc", {
							"@type": "g:Edge",
							"@value": {
								"id": "IT84",
								"label": "supplies",
								"inVLabel": "company",
								"outVLabel": "company",
								"inV": "KR7005930003",
								"outV": "US0378331005"
							}
						}]
					}
				}
			}, {
				"@type": "g:Path",
				"@value": {
					"labels": {
						"@type": "g:List",
						"@value": [{
							"@type": "g:Set",
							"@value": []
						}, {
							"@type": "g:Set",
							"@value": []
						}]
					},
					"objects": {
						"@type": "g:List",
						"@value": ["Apple Inc", {
							"@type": "g:Edge",
							"@value": {
								"id": "IT842",
								"label": "supplies",
								"inVLabel": "company",
								"outVLabel": "company",
								"inV": "US2855121099",
								"outV": "US0378331005"
							}
						}]
					}
				}
			}, {
				"@type": "g:Path",
				"@value": {
					"labels": {
						"@type": "g:List",
						"@value": [{
							"@type": "g:Set",
							"@value": []
						}, {
							"@type": "g:Set",
							"@value": []
						}]
					},
					"objects": {
						"@type": "g:List",
						"@value": ["Apple Inc", {
							"@type": "g:Edge",
							"@value": {
								"id": "IT1347",
								"label": "supplies",
								"inVLabel": "company",
								"outVLabel": "company",
								"inV": "US12514G1085",
								"outV": "US0378331005"
							}
						}]
					}
				}
			}]
		},
		"meta": {
			"@type": "g:Map",
			"@value": []
		}
	}
}"""

def generate_amcharts_json(df):
    json_network={}
    
    for obj in df['result']['data']["@value"]:
        key_from=obj["@value"]['objects']["@value"][1]["@value"]['outV']
        key_to=obj["@value"]['objects']["@value"][1]["@value"]['inV']
        if key_from not in json_network:
            json_network[key_from]={'name':key_from,'linkWith':[],"value":5}
        if key_to not in json_network:
            json_network[key_to]={'name':key_to,'linkWith':[],"value":5}
        json_network[key_from]['linkWith'].append(key_to)
    return {"data":list(json_network.values())}


def lambda_handler(event, context):
    return generate_amcharts_json(json.loads(df_edges))


print(lambda_handler("",""))
